'use strict'
var fs = require('fs')
var path = require('path')
var test = require('tape')
var YAML = require('yamljs')

var FASTQStream = require('..')

test('FASTQStream: use biofmtspecimens files as oracles', function (t) {
  var description = YAML.load('./test/test-data/index.yml')
  t.plan(description.length)
  for (var testcase of description) {
    var reader = fs.createReadStream(path.join('./test/test-data', testcase['filename']))
    if (testcase.valid) {
      reader.pipe(new FASTQStream())
            .on('data', function (data) {
              t.comment(data['name'])
            })
            .on('error', function () {
              t.fail(testcase['filename'])
            })
            .on('end', function () {
              t.pass(testcase['filename'])
            })
    } else {
      // t.notOk(reader.pipe(new FASTQStream()).on('end', function () {}))
    }
  }
})
